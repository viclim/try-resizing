<p>
  Click anywhere on the grid to create a square, then resize the window.
  <br />
  The square's top left corner should stick to the same spot on the grid.
  <br />
  The square resizes by having its dimension in percentage.
</p>
<div id="container">
  <img id="document" src="./bg.jpg" />
</div>

<style>
  #container {
    box-sizing: border-box;
    position: relative;
  }

  #document {
    box-sizing: border-box;
    width: 100%;
    z-index: 0;
  }

  .static {
    position: absolute;
    width: 6%;
    aspect-ratio: 1;
    text-align: center;
  }
  .bg-coloured {
    background-color: red;
    opacity: 0.9;
  }
</style>

<script>
  (function() {
    const getRelativeCoordinates = (dom) => {
      const parent = dom.parentElement.getBoundingClientRect();
      const rect = dom.getBoundingClientRect();
      return { x: rect.left - parent.left, y: rect.top - parent.top };
    };
    const getDimension = (dom) => {
      const rect = dom.getBoundingClientRect();
      return { width: rect.width };
    };
    const getRatio = (oriDimension,  dom) => {
      return getDimension(dom).width / oriDimension.width;
    };

    const clickzone = document.getElementById('container');
    const doc = document.getElementById('document');

    // First you get the original dimension of the document.
    const originalDimension = { width: 1800 };

    let ratio = getRatio(originalDimension, doc);
    clickzone.addEventListener('click', (e) => {
      const div = document.createElement('div');
      div.classList.add('bg-coloured', 'static', 'resizable');
      div.style.left = `${e.offsetX}px`;
      div.style.top = `${e.offsetY}px`;
      clickzone.appendChild(div);
      const coordinates = getRelativeCoordinates(div);
      div.dataset.x = coordinates.x / ratio;
      div.dataset.y = coordinates.y / ratio;
    });
    const resize = (e) => {
      ratio = getRatio(originalDimension, doc);

      const children = clickzone.querySelectorAll('.resizable');
      for (const child of children) {
        child.style.left = `${child.dataset.x * ratio}px`;
        child.style.top = `${child.dataset.y * ratio}px`;
      }
    };

    window.addEventListener('resize', resize);
  }());
</script>
