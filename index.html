<div id="container">
  <img id="document" src="./bg.jpg" />
</div>

<style>
  #container {
    box-sizing: border-box;
    position: relative;
  }

  #document {
    box-sizing: border-box;
    width: 100%;
    z-index: 0;
  }

  .static {
    position: absolute;
    width: 6%;
    aspect-ratio: 1;
    text-align: center;
  }
  .bg-coloured {
    background-color: red;
    opacity: 0.9;
  }
</style>

<script>
  (function() {

    const debounce = (func, timeout = 100) => {
      let timer;
      return (...args) => {
        clearTimeout(timer);
        timer = setTimeout(() => { func.apply(this, args); }, timeout);
      };
    };
    const getRelativeCoordinates = (dom) => {
      const parent = dom.parentElement.getBoundingClientRect();
      const rect = dom.getBoundingClientRect();
      return { x: rect.left - parent.left, y: rect.top - parent.top };
    };
    const getDimension = (dom) => {
      const rect = dom.getBoundingClientRect();
      return { width: rect.width, height: rect.height, hypot: Math.hypot(rect.width) };
    };
    const getRatio = (oriDimension,  dom) => {
      return getDimension(dom).hypot / oriDimension.hypot;
    };

    const clickzone = document.getElementById('container');
    const doc = document.getElementById('document');
    const originalDimension = { width: 1800, height: 1200, hypot: Math.hypot(1800, 1200) };

    let ratio = getRatio(originalDimension, doc);
    clickzone.addEventListener('click', (e) => {
      const div = document.createElement('div');
      div.classList.add('bg-coloured', 'static', 'resizable');
      div.style.left = `${e.offsetX}px`;
      div.style.top = `${e.offsetY}px`;
      clickzone.appendChild(div);
      const coordinates = getRelativeCoordinates(div);
      div.dataset.x = coordinates.x / ratio;
      div.dataset.y = coordinates.y / ratio;
    });
    const resize = (e) => {
      ratio = getRatio(originalDimension, doc);

      const children = clickzone.querySelectorAll('.resizable');
      for (const child of children) {
        child.style.left = `${child.dataset.x * ratio}px`;
        child.style.top = `${child.dataset.y * ratio}px`;
      }
    };

    window.addEventListener('resize', resize);
  }());
</script>
